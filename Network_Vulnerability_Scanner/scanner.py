import socket
import sys
from datetime import datetime

target_server = "scanme.nmap.org"
target_server_ip = socket.gethostbyname(target_server)
timeout = 0.4
start_num_port = 1
end_num_port = 101
num_threads = 0


def welcome_message():
    print("=" * 50)
    print("Welcome to the Network Vulnerability Scanner")
    print("Description: A multi-threaded scanner to discover open ports and ")
    print ("their respective Common Vulnerabilities and Exposures (CVEs)")
    print("=" * 50)
    print(f"Target IP Address: {target_server_ip} ({target_server})")
    print(f"Time Started: {str(datetime.now())}")
    print("-" * 50)

def finding_open_ports():
    count = 1
    try:
        for port in range(start_num_port, end_num_port):
            s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
            
            s.settimeout(timeout)
            
            result = s.connect_ex((target_server_ip, port))
            
            if result == 0:
                print(f"#{count}: Port {port} is OPEN")
                count+=1

            s.close()
            
    except KeyboardInterrupt:
        print("\n Program has been interrupted. Exiting program.")
        sys.exit()

    except socket.error:
        print("\n Server has an error.")
        sys.exit()

def main() -> None:
    welcome_message()
    finding_open_ports()



if __name__ == "__main__":
    main()